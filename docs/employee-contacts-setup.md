# GS동해전력 연락처 Google Sheets 연동 가이드

## 개요
GS동해전력 임직원 연락처를 Google Sheets에서 실시간으로 가져와 비상상황 시 자동 SMS 발송에 활용합니다.

## ✅ 현재 설정된 Google Sheets
- **URL**: https://docs.google.com/spreadsheets/d/1m3vgTSxEVMT__vbIoeM5ULAfUGCsmuUoGUk5x54RA-c/edit?usp=sharing
- **Spreadsheet ID**: `1m3vgTSxEVMT__vbIoeM5ULAfUGCsmuUoGUk5x54RA-c`
- **용도**: GS동해전력 임직원 연락처 관리
- **업데이트**: 실시간 자동 동기화
- **상태**: ✅ 연동 완료

## 데이터 구조
Google Sheets의 첫 번째 시트에서 다음 형식으로 데이터를 읽어옵니다:

| A열: 소속팀/직책 | B열: 이름 | C열: 전화번호 | D열: 역할 | E열: 임무 |
|------------------|-----------|---------------|-----------|-----------|
| 대표이사 | 김대표 | 010-1234-5678 | 총괄지휘 | 비상대응 총괄 |
| 발전파트장 | 박파트장 | 010-2345-6789 | 현장대응 | 현장 지휘 |
| 비상대응팀장 | 이팀장 | 010-3456-7890 | 비상연락 | 연락망 운영 |

### 필수 컬럼
- **A열 (소속팀/직책)**: 부서 또는 직책명
- **B열 (이름)**: 담당자 이름
- **C열 (전화번호)**: 휴대폰 번호 (010-XXXX-XXXX 형식)

### 선택 컬럼
- **D열 (역할)**: 비상상황 시 역할 설명
- **E열 (임무)**: 구체적인 임무 내용

## 비상연락망 우선순위
부서/직책에 따라 비상상황 시 SMS 발송 우선순위가 자동으로 결정됩니다:

1. **대표이사** (commander) - 총괄 지휘
2. **발전파트장** (field_response_leader) - 현장 대응 지휘
3. **비상대응팀장** (emergency_contact_leader) - 긴급 연락망 운영
4. **안전관리팀** (safety_coordinator) - 안전 조치 조율

## 시스템 연동 정보

### 환경 변수
\`\`\`env
EMPLOYEE_SPREADSHEET_ID=1m3vgTSxEVMT__vbIoeM5ULAfUGCsmuUoGUk5x54RA-c
\`\`\`

### API 엔드포인트
- **연락처 조회**: `/api/contacts`
- **SMS 발송**: `/api/send-sms`

### 코드 위치
- **Google Sheets 연동**: `lib/google-sheets.ts`
- **연락처 조회 로직**: `lib/contact-lookup.ts`
- **UI 컴포넌트**: `app/contacts/page.tsx`

## 기능
- ✅ 실시간 데이터 동기화
- ✅ 비상상황 시 자동 SMS 발송
- ✅ 오류 시 목업 데이터 자동 대체
- ✅ 비상연락망 우선순위 자동 관리
- ✅ 전화번호 자동 포맷팅 (하이픈 제거)
- ✅ 활성/비활성 상태 관리

## 사용 방법

### 1. 연락처 추가
Google Sheets에서 새로운 행을 추가하면 자동으로 시스템에 반영됩니다.

### 2. 연락처 수정
Google Sheets에서 직접 수정하면 다음 조회 시 자동으로 업데이트됩니다.

### 3. 연락처 확인
웹 애플리케이션의 "명단 관리" 메뉴에서 실시간 연락처를 확인할 수 있습니다.

### 4. 비상 알림 발송
사고 신고 시 시스템이 자동으로 모든 활성 임직원에게 SMS를 발송합니다.

## 주의사항
- ⚠️ Google Sheets는 '링크가 있는 모든 사용자' 권한으로 공유되어야 합니다
- ⚠️ 첫 번째 행은 헤더로 사용되므로 데이터는 두 번째 행부터 입력해야 합니다
- ⚠️ 전화번호는 010-XXXX-XXXX 형식으로 입력해주세요 (하이픈은 자동으로 제거됨)
- ⚠️ A열(소속팀/직책), B열(이름), C열(전화번호)는 필수 입력 항목입니다

## 문제 해결

### Google Sheets 접근 오류
1. 스프레드시트 공유 설정 확인
2. Google Sheets API 활성화 확인
3. API 키 유효성 확인

### 데이터가 표시되지 않음
1. 스프레드시트 ID 확인
2. 데이터 형식 확인 (A, B, C열 순서)
3. 헤더 행 존재 여부 확인

### SMS 발송 실패
1. 전화번호 형식 확인
2. SMS API 키 설정 확인
3. 활성 상태 확인
